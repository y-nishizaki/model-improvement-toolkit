# 特徴量重要度分析機能 要件仕様書

**作成日**: 2025-07-20
**最終更新**: 2025-07-20
**ステータス**: Implemented

## 機能概要
モデルの特徴量重要度を詳細に分析し、特徴量選択や改善の示唆を提供する機能。

## ユーザーストーリー

### US-FI-001: 特徴量重要度ランキング ✅
**As a** データサイエンティスト
**I want** 特徴量の重要度ランキングを確認する
**So that** どの特徴量が予測に寄与しているか理解できる

**受け入れ基準:**
- GIVEN モデルと特徴量名
- WHEN FeatureImportanceAnalyzer.analyze()を実行
- THEN 以下が提供される
  - 重要度順にソートされた特徴量リスト
  - 正規化された重要度スコア（0-100）
  - 累積重要度曲線

### US-FI-002: 特徴量選択提案 ✅
**As a** データサイエンティスト
**I want** 重要度に基づいた特徴量選択の提案を受ける
**So that** モデルを簡素化し性能を維持できる

**受け入れ基準:**
- GIVEN 特徴量重要度分析結果
- WHEN suggest_feature_selection()を実行
- THEN 以下が提供される
  - 選択すべき特徴量リスト
  - 削除可能な特徴量リスト
  - 期待される次元削減率

## 機能仕様

### 実装済み機能 ✅
1. **FeatureImportanceAnalyzer** (analysis/feature_importance.py)
   - 重要度スコア取得（gain/split）
   - 重要度ランキング生成
   - 累積重要度計算
   - 低重要度特徴量の特定
   - 重要度統計（平均、標準偏差、Gini係数）
   - 特徴量グループ化（critical/high/medium/low）

2. **特徴量選択提案機能**
   - 累積重要度閾値による選択
   - 最小特徴量数の保証
   - 削減率の計算

### 未実装機能 🔲
1. **Permutation Importance**
2. **SHAP値による重要度分析**
3. **時系列での重要度変化追跡**

## 技術仕様
- **重要度タイプ**: gain（デフォルト）、split
- **累積重要度閾値**: 50%, 70%, 80%, 90%, 95%, 99%
- **低重要度閾値**: 最大重要度の1%未満

## 依存関係
- **モデルラッパー**: BaseModelWrapper実装が必要 ✅
- **統合先**: LightGBMAnalyzer, XGBoostAnalyzer